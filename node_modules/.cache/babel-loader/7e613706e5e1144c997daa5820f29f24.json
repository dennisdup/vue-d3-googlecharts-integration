{"remainingRequest":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/thread-loader/dist/cjs.js!/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/babel-loader/lib/index.js!/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/cache-loader/dist/cjs.js??ref--0-0!/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/vue-loader/lib/index.js??vue-loader-options!/opt/lampp/htdocs/ac_frontend_app/public/development/src/views/form-field.vue?vue&type=script&lang=js&","dependencies":[{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/src/views/form-field.vue","mtime":1558007216431},{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/lampp/htdocs/ac_frontend_app/public/development/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport FileUpload from 'vue-upload-component';\nimport { dataService } from \"./dataService.js\";\nimport alphaArea from \"./alpha-area.vue\";\nimport modal from \"./Modal.vue\";\nexport default {\n  data: function data() {\n    return {\n      downloadModal: false,\n      toNow: this.form.value.to && this.form.value.to === 'Now' ? true : false,\n      loading: false,\n      showInfoText: false,\n      licenses: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],\n      events: {\n        add: add\n      }\n    };\n  },\n  methods: {\n    downloadURI: downloadURI,\n    getFileName: getFileName,\n    attachDatepicker: attachDatepicker,\n    attachCompanies: attachCompanies,\n    attachLicenses: attachLicenses\n  },\n  props: {\n    form: Object,\n    companies: Array,\n    index: Number\n  },\n  watch: {\n    'companies': function companies(nVal) {\n      if (nVal && this.form.type === 'companies') {\n        this.attachCompanies(nVal, \".field-\".concat(this.index, \"-companies\"), this.form.value);\n      }\n    },\n    'toNow': function toNow(nVal) {\n      if (nVal && nVal !== 'initial') {\n        this.form.value.to = 'Now';\n      }\n    },\n    'form.value.to': function formValueTo(nVal) {\n      if (nVal !== 'Now') this.toNow = false;\n    }\n  },\n  mounted: function mounted() {\n    //initialize pop ups\n    $('[data-toggle=\"popover\"]').popover();\n\n    if (this.form.type === 'date') {\n      this.attachDatepicker(\".field-\".concat(this.index, \"-datepicker\"));\n    }\n\n    if (this.form.type === 'date-range') {\n      if (!this.form.value || typeof this.form.value === 'string' || !this.form.value.from) {\n        this.form.value = {\n          'from': '',\n          'to': ''\n        };\n      }\n\n      this.attachDatepicker(\".field-from-\".concat(this.index, \"-datepicker\"), 'from');\n      this.attachDatepicker(\".field-to-\".concat(this.index, \"-datepicker\"), 'to');\n    }\n\n    if (this.form.type === 'companies') {\n      console.log('this fires');\n\n      if (!this.form.value || typeof this.form.value === 'string') {\n        this.form.value = [];\n      }\n\n      if (this.companies) {\n        console.log('this fires1');\n        this.attachCompanies(this.companies, \".field-\".concat(this.index, \"-companies\"), this.form.value);\n      }\n    }\n\n    if (this.form.type === 'licenses') {\n      if (!this.form.value || typeof this.form.value === 'string') {\n        this.form.value = [];\n      }\n\n      this.attachLicenses(this.licenses.map(function (l) {\n        return \"Type \".concat(l);\n      }), \".field-\".concat(this.index, \"-licenses\"), this.form.value);\n    }\n  },\n  components: {\n    FileUpload: FileUpload,\n    modal: modal,\n    alphaArea: alphaArea\n  }\n};\n\nfunction attachCompanies(companies, sel, selected) {\n  var self = this;\n  this.$nextTick(function () {\n    if ($(sel).find('option').length < 1) {\n      companies.forEach(function (company) {\n        $(sel).append('<option value=\"' + company._id + '\">' + company.name + '</option>');\n      });\n    }\n\n    if (selected) $(sel).val(selected);\n    $(sel).selectpicker('refresh').on('change', function (ev) {\n      var companiesChosen = [];\n      $(ev.target).find(\"option:selected\").each(function (ind, i) {\n        companiesChosen.push($(i).val());\n      });\n      self.form.value = companiesChosen;\n    });\n  });\n}\n\nfunction attachLicenses(licenses, sel, selected) {\n  var self = this;\n  this.$nextTick(function () {\n    if ($(sel).find('option').length < 1) {\n      licenses.forEach(function (l) {\n        $(sel).append(\"<option value=\\\"\".concat(l, \"\\\">\").concat(l, \"</option>\"));\n      });\n    }\n\n    if (selected) $(sel).val(selected);\n    $(sel).selectpicker('refresh').on('change', function (ev) {\n      var licensesChosen = [];\n      $(ev.target).find(\"option:selected\").each(function (ind, i) {\n        licensesChosen.push($(i).val());\n      });\n      self.form.value = licensesChosen;\n    });\n  });\n}\n\nfunction attachDatepicker(el, type) {\n  var self = this;\n  self.$nextTick(function () {\n    $(el).datepicker({\n      dateFormat: 'dd M yy',\n      changeYear: true\n    }).on('change', function (ev) {\n      var date = ev.target.value;\n\n      if (!type) {\n        self.form.value = date;\n      } else {\n        self.form.value[type] = date;\n      }\n    });\n  });\n}\n\nfunction getFileName(link) {\n  if (!link) {\n    return '';\n  } else if (link.includes('http')) {\n    return link.substring(link.lastIndexOf('/') + 1);\n  } else {\n    return link;\n  }\n}\n\nfunction downloadURI(uri) {\n  this.downloadName = this.getFileName(uri);\n  this.downloadModal = true;\n  if (!uri) return;\n  var link = document.createElement(\"a\");\n  link.href = uri;\n  link.download = this.getFileName(uri);\n  link.target = \"_blank\";\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\nfunction add(file, component) {\n  var self = this;\n  self.form = new window.FormData();\n\n  for (var key in file.data) {\n    if (typeof file.data[key] != 'string') {\n      self.form.append(key, JSON.stringify(file.data[key]));\n    } else {\n      self.form.append(key, file.data[key]);\n    }\n  }\n\n  self.form.append('file', file.file);\n  self.$parent.loading = true;\n  self.$http.post('/subscriptions/upload-html', self.form).then(function (resp) {\n    self.$parent.form.value = resp.body;\n    self.$parent.loading = false;\n    self.$parent.$forceUpdate();\n  }).catch(function (err) {\n    self.$parent.loading = false;\n    self.$parent.$parent.msg = 'Error uploading file';\n  });\n}",{"version":3,"sources":["form-field.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<!-- Column -->\n<div class=\"col-xl-12\">\n  <!-- Card Shadow -->\n  <div class=\"card shadow mb-4\">    \n    <!-- Card Body -->\n    <div class=\"card-body\">                  \n                \n\n      <div class=\"form-group\" v-if=\"form.type === 'string'\">\n        <label>\n          {{form.name}}\n        </label>\n        <alpha-area :mainObj=\"form\" :field=\"'value'\"></alpha-area>\n        <small class=\"form-text text-muted\">\n          <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n          <span v-if=\"form.help\" class=\"glyphicon glyphicon-info-sign relative\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\"> <span class=\"help-text\"  v-if=\"showInfoText && form.help\">{{form.help}}</span></span>\n        </small>\n      </div>\n\n      <div class=\"form-check\" v-if=\"form.type === 'checkbox'\">\n        <input type=\"checkbox\" class=\"form-check-input\" v-model=\"form.value\"> \n        <label class=\"form-check-label\" > \n            <span class=\"action-text mr-10\">{{form.name}}</span>             \n        </label>\n        <small class=\"form-text text-muted\">\n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <span v-if=\"form.help\" style=\"margin-right: 10px;\" class=\"glyphicon glyphicon-info-sign relative\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\"> \n            <span v-if=\"showInfoText && form.help\">{{form.help}}</span></span> \n        </small>\n      </div>\n\n\n      <div v-if=\"form.type === 'yes-no'\">\n        <div class=\"\">\n          <span v-text=\"form.name\"></span>\n          <small class=\"form-text text-muted pull-right\">\n              <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n              <a v-if=\"form.help\" tabindex=\"0\" data-toggle=\"popover\" data-trigger=\"hover\" :data-content=\"form.help\">\n                <i class=\"fas fa-info-circle\"></i>\n              </a>\n          </small>  \n        </div> \n        <div class=\"form-check form-check-inline\">\n          <input  class=\"form-check-input\" type=\"radio\" value=\"yes\" v-model=\"form.value\">\n          <label class=\"form-check-label\">Yes</label>\n        </div>\n        <div class=\"form-check form-check-inline\">\n          <input  class=\"form-check-input\" type=\"radio\" value=\"no\" v-model=\"form.value\">\n          <label class=\"form-check-label\">No</label>\n        </div>\n        <div class=\"form-check form-check-inline\">\n          <input class=\"form-check-input\" type=\"radio\" value=\"NA\" v-model=\"form.value\">\n          <label class=\"form-check-label\" > NA</label>\n        </div>\n      </div>\n\n      <div class=\"form-group\" v-if=\"form.type === 'file'\">\n        <label class=\"userinfo-label space-between\" for=\"role\">\n          <span class=\"action-text\">{{form.name}}</span> \n          <div>\n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <span v-if=\"form.help\" class=\"glyphicon glyphicon-info-sign relative\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\"> <span class=\"help-text\" v-if=\"showInfoText && form.help\">{{form.help}}</span></span>\n          </div>\n        </label>\n        <div class=\"image-el\" >\n          <p>\n            <span :class=\"{'task-link': form.value}\" @click=\"downloadURI(form.value)\" v-text=\"getFileName(form.value)\"></span>\n          </p> \n          <div v-show=\"loading\" class=\"spinner\"><div class=\"bounce1\"></div><div class=\"bounce2\"></div><div class=\"bounce3\"></div></div>\n          <file-upload :events=\"events\" accept=\".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf,.csv\" ></file-upload>\n        </div>\n      </div>\n \n      <div v-if=\"form.type === 'date'\" class=\"form-group\">\n        <label class=\"userinfo-label space-between\" for=\"role\">\n          <span class=\"action-text\">{{form.name}}</span> \n          <div>\n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <span v-if=\"form.help\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\" class=\"glyphicon glyphicon-info-sign relative\" > <span class=\"help-text\" v-if=\"showInfoText && form.help\">{{form.help}}</span></span>\n          </div>\n        </label>\n        <input class=\"user-info-fields form-control input-sm\" :class=\"`field-${index}-datepicker`\" v-model=\"form.value\">\n      </div>\n\n      <div v-if=\"form.type === 'companies'\" class=\"form-group\">\n        <label class=\"userinfo-label space-between\" for=\"role\">\n          <span class=\"action-text\">{{form.name}}</span> \n          <div>\n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <span v-if=\"form.help\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\" class=\"glyphicon glyphicon-info-sign relative\" > <span class=\"help-text\" v-if=\"showInfoText && form.help\">{{form.help}}</span></span>\n          </div>\n        </label>\n        <div>\n          <select class=\"selectpicker select-button form-field-companies\" :class=\"`field-${index}-companies`\" multiple data-actions-box=\"true\" data-live-search=\"true\"></select>\n        </div>\n      </div>\n\n      <div v-if=\"form.type === 'licenses'\" class=\"form-group\">\n        <label class=\"userinfo-label space-between\" for=\"role\">\n          <span class=\"action-text\">{{form.name}}</span> \n          <div>\n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <span v-if=\"form.help\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\" class=\"glyphicon glyphicon-info-sign relative\" > <span class=\"help-text\" v-if=\"showInfoText && form.help\">{{form.help}}</span></span>\n          </div>\n        </label>\n        <div>\n          <select class=\"selectpicker select-button form-field-licenses\" :class=\"`field-${index}-licenses`\" multiple></select>\n        </div>\n      </div>\n\n      <div v-if=\"form.type === 'date-range'\" class=\"form-group\">\n        <div class=\"date-range\">\n          <label>\n            <span class=\"action-text\">{{form.name}}</span> \n            <span v-if=\"form.dueDate\">Due: {{form.dueDate}}</span> \n            <div>\n              \n              <span v-if=\"form.help\" @mouseover=\"showInfoText = true;\" @mouseleave=\"showInfoText = false;\" class=\"glyphicon glyphicon-info-sign relative\" > <span class=\"help-text\" v-if=\"showInfoText && form.help\">{{form.help}}</span></span> From\n            </div>\n          </label>\n          <input class=\"user-info-fields form-control input-sm\" :class=\"`field-from-${index}-datepicker`\" v-model=\"form.value.from\">\n        </div>\n        <div class=\"date-range relative\">\n          <label>To </label>\n          <label class=\"to-now\">Now <input type=\"checkbox\" v-model=\"toNow\"></label>\n          <input class=\"user-info-fields form-control input-sm\" :class=\"`field-to-${index}-datepicker`\" v-model=\"form.value.to\">\n        </div>\n      </div>\n\n      <modal v-if=\"downloadModal\" :width=\"'600px'\" @close=\"downloadModal = false;\">\n        <h4 slot=\"header\"></h4>\n        <div slot=\"body\" >\n          <h4>Your download will finish in a moment, please check your downloads folder for a file named '{{downloadName}}'.</h4>\n        </div>\n        <div slot=\"footer\">\n          <button class=\"btn btn-default btn-sm\" @click=\"downloadModal = false;\">OK</button>\n        </div>\n      </modal>\n    \n\n    </div>\n    <!-- End Card Body -->\n  </div>\n  <!-- End Card Shadow -->\n</div>\n<!-- End Column -->\n</template>\n<script>\nimport FileUpload from 'vue-upload-component';\nimport { dataService } from './dataService.js';\nimport alphaArea from './alpha-area.vue';\nimport modal from './Modal.vue';\n\nexport default {\n  data() {\n    return {\n      downloadModal: false,\n      toNow: this.form.value.to && this.form.value.to === 'Now' ? true : false,\n      loading: false,\n      showInfoText: false,\n      licenses: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],\n      events: {\n        add\n      }\n    }\n  },\n  methods: {\n    downloadURI, getFileName, attachDatepicker, attachCompanies, attachLicenses\n  },\n  props: {\n    form: Object,\n    companies: Array,\n    index: Number\n  },\n  watch: {\n    'companies': function(nVal) {\n      if (nVal && this.form.type === 'companies') {\n        this.attachCompanies(nVal, `.field-${this.index}-companies`, this.form.value);\n      }\n    },\n    'toNow': function(nVal) {\n      if (nVal && nVal !== 'initial') {\n        this.form.value.to = 'Now';\n      }\n    },\n    'form.value.to': function(nVal) {\n      if (nVal !== 'Now') this.toNow = false;\n    }\n  },\n  mounted() {\n    //initialize pop ups\n    $('[data-toggle=\"popover\"]').popover();\n    \n    if (this.form.type === 'date') {\n      this.attachDatepicker(`.field-${this.index}-datepicker`);\n    }\n\n    if (this.form.type === 'date-range') {\n      if (!this.form.value || typeof this.form.value === 'string' || !this.form.value.from) {\n        this.form.value = {'from': '', 'to': ''};\n      }\n\n      this.attachDatepicker(`.field-from-${this.index}-datepicker`, 'from');\n      this.attachDatepicker(`.field-to-${this.index}-datepicker`, 'to');\n    }\n\n    if (this.form.type === 'companies') {\n      console.log('this fires');\n      if (!this.form.value || typeof this.form.value === 'string') {\n        this.form.value = [];\n      }\n      if (this.companies) {\n        console.log('this fires1');\n        this.attachCompanies(this.companies, `.field-${this.index}-companies`, this.form.value);\n      }\n    }\n\n    if (this.form.type === 'licenses') {\n      if (!this.form.value || typeof this.form.value === 'string') {\n        this.form.value = [];\n      }\n      this.attachLicenses(this.licenses.map(l => `Type ${l}`), `.field-${this.index}-licenses`, this.form.value);\n    }\n  },\n  components: {\n    FileUpload, modal, alphaArea\n  }\n}\nfunction attachCompanies(companies, sel, selected) {\n  let self = this;\n  this.$nextTick(() => {\n    if ($(sel).find('option').length < 1) {\n      companies.forEach(function(company) {\n        $(sel).append('<option value=\"'+company._id+'\">'+company.name+'</option>');\n      });\n    }\n    if (selected) $(sel).val(selected);\n    $(sel).selectpicker('refresh').on('change', (ev) => {\n      let companiesChosen = [];\n      $(ev.target).find(\"option:selected\").each(function(ind, i) {\n        companiesChosen.push($(i).val());\n      });\n      self.form.value = companiesChosen; \n    });\n  });\n}\n\nfunction attachLicenses(licenses, sel, selected) {\n  let self = this;\n  this.$nextTick(() => {\n    if ($(sel).find('option').length < 1) {\n      licenses.forEach(function(l) {\n        $(sel).append(`<option value=\"${l}\">${l}</option>`);\n      });\n    }\n    if (selected) $(sel).val(selected);\n    $(sel).selectpicker('refresh').on('change', (ev) => {\n      let licensesChosen = [];\n      $(ev.target).find(\"option:selected\").each(function(ind, i) {\n        licensesChosen.push($(i).val());\n      });\n      self.form.value = licensesChosen; \n    });\n  });\n}\n\nfunction attachDatepicker(el, type) {\n  let self = this;\n  self.$nextTick(() => {\n    $(el).datepicker({dateFormat: 'dd M yy', changeYear: true}).on('change', function (ev) {\n      let date = ev.target.value;\n      if (!type) {\n        self.form.value = date;\n      } else {\n        self.form.value[type] = date;\n      }\n    });\n  });\n}\n\nfunction getFileName(link) {\n  if (!link) {\n    return '';\n  } else if (link.includes('http')) {\n    return link.substring(link.lastIndexOf('/') + 1);\n  } else {\n    return link;\n  }\n}\n\nfunction downloadURI(uri) {\n  this.downloadName = this.getFileName(uri);\n  this.downloadModal = true;\n  if (!uri) return;\n  let link = document.createElement(\"a\");\n  link.href = uri;\n  link.download = this.getFileName(uri);\n  link.target = \"_blank\";\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\nfunction add(file, component) {\n  let self = this;\n  self.form = new window.FormData();\n  for (var key in file.data) {\n    if (typeof file.data[key] != 'string') {\n      self.form.append(key, JSON.stringify(file.data[key]));\n    } else {\n      self.form.append(key, file.data[key]);\n    }\n  }\n  self.form.append('file', file.file);\n  self.$parent.loading = true;\n  self.$http.post('/subscriptions/upload-html', self.form).then(resp => {\n    self.$parent.form.value = resp.body;\n    self.$parent.loading = false;\n    self.$parent.$forceUpdate();\n  }).catch(err => {\n    self.$parent.loading = false;\n    self.$parent.$parent.msg = 'Error uploading file'\n  })\n}\n\n</script>"],"sourceRoot":"src/views"}]}